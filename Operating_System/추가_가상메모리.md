## 가상메모리란?
- 한 시스템의 여러 프로세스들은 CPU와 메인메모리를 공유함
- CPU 공유에선 사실상 오류가 잘 발생하지 않음. 그냥 프로세스 순서를 기다리느라 느려질 뿐.
- 근데 메인메모리는, 프로세스가 너무 많아서 메모리에 지나치게 많은 요구를 할때, 오염될수있고 프로그램 논리와 무관하게 오류가 발생함
- 이를 방지하기 위한 기술이 **가상 메모리** 임

<br>

- 보통 운영체제가 자동으로 가상 메모리를 관리하고 작동시킴
- 프로세스를 올리고 내림에 있어서 운영체제가 자동으로 가상메모리를 활용해서 메모리를 관리함

<br>

- 가상 메모리 접근은 결국 물리메모리 접근으로 이어짐
- 가상메모리는 프로세스들 각각의 비어잇는 메모리 영역을 가상메모리로 부여함

<br>
<br>
<br>

## 가상 메모리 기능
1. 메모리 관리 단순화 : 각 프로세스 마다 가상 메모리의 통일된 주소 공간을 배정할 수 있어서 메모리 관리가 단순함
2. 메모리 용량 및 안정성 보장 : 한정된 공간의 램이 아닌 거의 무한한 가상 메모리 공간을 배정함으로써 프로세스들끼리 메모리 침범이 일어나지 않게 함

<br>
<br>
<br>

## 가상 메모리 방식
- CPU에 MMU(Memory Management Unit)이 대부분 내장되어 있음
- 각 프로세스가 독립된 가상 주소 공간을 가짐. A프로세스에서 0x1000 라는 주소를 가지고, 동시에 B프로세스에서 0x1000 주소를 가질 수 있음
- 두 프로세스의 각각 0x1000 주소 접근 하라는 명령에서, CPU는 각 프로세스마다 별도 가지고 있는 **페이지 테이블** 대상을 참조해, 실제 물리 주소를 참조함
- **페이지 테이블**은 가상주소와 물리주소를 매칭해둔 테이블임
- 가령 A의 0x1000 가상 주소는 실제 물리주소 0x300000이고, B프로세스의 0x1000 가상주소는 실제 물리주소 0x400000를 가리킴
- 이렇게 두 프로세스는 동일한 주소를 가리키지만, MMU가 해당 페이지 테이블을 참조하여 실제 물리메모리 주소를 얻고, 해당되는 물리 주소를 참조함
- 이러면 두 프로세스 주소공간이 겹치지 않고 독립적으로 실행될 수 있음

<br>

- 운영 체제는 메모리 모든 내용을 그대로 물리 메모리에 저장하지 않음.
- 사용하지 않는 페이지(데이터)는 디스트안에 있는 페이지파일에 옮겨둬서, 빈 페이지를 만들어둬서 다음에 다른 프로세스 진행할때 바로 데이터 불러와서 저장할 수 있도록 비워둠(페이지 교체 방식)

<br>

- 이때 프로세스 주소 참조하기 위해 CPU가 해당 프로세스 페이지 테이블을 참조하는데, 요청한 페이지가 물리 메모리에 없고 디스크 안에도 없을때 페이지 폴트가 발생함
- 이 경우 운영체제는 요청한 페이지를 페이지 파일에서 가져와 물리 메모리에 적재하는 작업을 함

<br>

- **페이지 폴트** 란?
  - 어떤 페이지에 접근하려는데, 해당 페이지가 실체 물리메모리에 없을때, 인터럽트 발생함.
  - 찾는 프로세스 주소가 가상메모리의 주소공간에는 있는제 실제 시스템 RAM에는 존재하지 않는 상태로, 데이터와 코드에 접근하려 할때 발생하는 현상을 말함
  - 페이지 폴트가 발생하면, 인터럽트가 발생하고, CPU에서 가상메모리 데이터를 물리 메모리에 적재해서, 다시 프로그램을 작동시킴
 
  - 페이지 폴트 많이 발생 -> 운영체제 성능 저하
  - 이를 예방하기 위해 **페이지 교체 정책**
  - 페이지 교체 정책이란?
    - 메모리가 full일때, 기존 페이지 중 하나를 물리메모리에서 저장매채(가상메모리)로 내리고, 다음 작동할 페이지를 방금 비운 물리 메모리에 올림

<br>
<br>
<br>

## 캐시
### TLB(Translate Lookaside Buffer)
- buffer : 컴퓨터 완충 기억 장치
- TLB란?
  - 가상 메모리 주소는 물리주소로 변환하는 속도를 높이려고, 캐시를 사용해서, 가상주소 - 물리주소 테이블을 버퍼에 저장한 걸 의미함
  - CPU는 가상 메모리의 데이터에 접근할때, TLB에 접근해서 해당 가상주소의 물리주소를 참조해서 메모리에 접근함.
  - TLB에 없으면, MMU가 페지이 테이블에서 해당되는 물리주소로 변환한 후에 메모리에 접근함.
  - MMU에 포함되는 작은 캐시임. 일종의 주소변환 캐시. MMU의 buffer에 저장해두고 참조하거나, 해당 물리주소가 없으면 MMU가 물리주소 반환해줌. 그렇게 데이터에 접근함

<br>

- 케시 메모리
  - 속도 빠른 장치(CPU)와 느린 장치(메모리 - CPU에 비해 저속) 사이의 속도차에 의한 **병목현상**을 줄이기 위한 범용 메모리
  - 웹브라우저의 캐시 개념. 캐시파일은? 웹 페이지 상의 이미지 등을 하드디스크에 저장해서, 다음에 동일한 웹페이지에 접근할때, 다시 요청하지 않고, 하드디스크에서 불러오는 방식이며, 그러 인해 로딩 시간을 줄여줌(로딩 속도를 높여줌)
 
<br>
<br>
<br>

## 가상 메모리 관리 방시 2가지
- 세그먼트
- 페이징

<br>
<br>
<br>
