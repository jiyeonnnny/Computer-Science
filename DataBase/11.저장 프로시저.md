# 저장 프로시저
```
프로시저 vs 함수

프로시저 : 어떤 업무를 수행하기 위한 절차
예를 들어, 계좌 송금해야함
1. 상대방 계좌를 입력
2. 내 계좌에 금액이 충분한지 확인
3. 내 계좌에서 돈이 빠짐
4. 상대방 계좌에 돈이 입금됨
이처럼 프로세스를 절차적으로 기술한 것을 '프로시저'라고 함

함수 : 프로시저의 각 프로세스를 수행하기 위한 기능
예를 들어, 내 계좌에 금액이 충분한지 체크하는 기능으로 정의된 함수
```

<br>

## 저장 프로시저란?
- 저장 프로시저(stored procedure)
- SP(저장프로시저)는 일련의 쿼리를 하나의 함수처럼 실행하기 위한 쿼리 집합(순서가 없나)
- 요약 : 특정 로직 쿼리를 함수로 만들어 놓은 것
- 자주 사용하는 쿼리를 함수로 한번 만들면, 성능 상 좋고, 코드 재사용성 등 여러 이점이 있음

<br>

## 프로시저의 장점
1. 최적화 & 캐시
   - 프로시저 최초 실행할때, 최적화 상태로 컴파일됨. 그 후에는 캐시에 저장됨.
   - 만약 해당 프로세스가 여러번 사용되면, 컴파일 작업 생략 바로 캐시에서 불러옴
  
2. 유지 보수
   - 작업이 변경될때, 다른 작업 건드릴 필요없이 프로시저 내부에서 수정만 하면 됨
  
3. 트래픽 감소
   - 클라이언트가 직접 SQL문을 작성안해도, 프로시저명에 매개변수만 담아 전달하면 됨
   - 즉 SQL문이 서버에 이미 저장되어 있으니, 클라이언트와 서버간 네티워크상 트래픽이 감소함
  
4. 보안
   - 프로시저 내에서 참조 중인 테이블의 접근을 막을 수 있음

<br>

## 프로시저의 단점
1. 호환성 : 구문 규칙이 SQL표준과 호환성이 낮아서, 코드 자산으로의 재사용성이 나쁨
2. 성능 : 문자 혹은 숫자 연산에서 프로그래밍 언어 C/JAVA 보다 성능이 느림
3. 디버깅 : 에러 발생하면, 어디서 잘못된지 알기 힘듬
