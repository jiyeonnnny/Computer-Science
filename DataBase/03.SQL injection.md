# SQL injection
---
## SQL injection
- 해커에 의해 조작된 SQL 쿼리문이 DB에 그대로 전달되어 비정상적 명령을 실행하는 공격기법을 의미함

<br>
<br>
<br>

## 공격방법
### 1. 인증 우회
- 보통 로그인할때, 아이디 비밀번호 input창에 입력함. SQL injection으로 공격할때, input창에 비밀번호를 입력함과 동시에 다른 쿼리문을 함께 입력함
```
SELECT * FROM USER WHERE ID = "abs" AND PASSWORD = "1234";
```
```
1234; DELETE * USER FROM ID="1";
```
- 보안이 완벽하지 않을 경우, 이처럼 비밀번호와 아이디가 일치해서 true가 되고 작성한 delete문도 DB에 영향을 줄 수 있게 되며 치명타를 입힐 수 있음
- 이 외 기본 쿼리문의 WHERE절의 OR문을 추가해서 '1'='1' 과 같은 true문을 작성해 무조건 적용되도록 수정한 뒤 DB를 맘대로 조작할 수 있음

### 2. 데이터 노출
- 시스템에서 발생하는 에러 메세지를 이용해 공격함
- 보통 에러는 개발자가 버그를 수정하는 면에서 도움받을 수 있음. 해커들은 이를 역이용해서 악의적인 구문을 삽입해서, 에러를 유발시킴
- 예를 들어, 해커는 GET방식으로 동작하는 URL 쿼리 스트링을 추가하여 에러를 발생시킴. 이에 해당하는 오류가 발생하면, 이를 통해 해당 웹앱의 데이터베이스 구조를 유추할 수 있고 해킹에 활용함.


<br>
<br>
<br>

## 방어방법

### 1. input값을 받을때 특수문자 여부 검사
- 로그인 하기 전, 검증 로직을 추가해서 미리 설정한 특수문자들이 들어왔을때 요청을 막아냄

### 2. SQL 서버 오류 발생시, 해당하는 에러 메세지 감추기
- view를 활용해 원본DB 테이블에는 접근 권한을 높임. 일반사용자는 view로만 접근해서 에러를 볼 수 없도록 만듬

### 3. preparestatement 사용하기
- preparestatement를 사용하면, 특수문자를 자동으로 escaping해줌
- statement와 다르게 쿼리문에서 전달하는 인자값을 ?로 받음
- 이걸 활용해 서버측에서 필터링 과정을 통해 공격을 방어함


<br>
<br>
<br>
